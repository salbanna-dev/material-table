import MaterialTable from "material-table";
import { saveAs } from 'file-saver';
import XLSX from 'xlsx';

const MyTable = () => {
  return (
    <MaterialTable
      title="My Exportable Table"
      columns={[
        { title: 'Name', field: 'name' },
        { title: 'Surname', field: 'surname' },
        { title: 'Birth Year', field: 'birthYear', type: 'numeric' },
        { title: 'Birth City', field: 'birthCity', lookup: { 34: 'İstanbul', 63: 'Şanlıurfa' } }
      ]}
      data={[
        { name: 'Mehmet', surname: 'Baran', birthYear: 1987, birthCity: 63 },
        { name: 'Zerya Betül', surname: 'Baran', birthYear: 2017, birthCity: 34 },
      ]}
      options={{
        exportButton: true,
      }}
      onExport={(columns, data) => {
        const ws = XLSX.utils.json_to_sheet([
          {}, {},  // Two empty rows
          ...data.map(rowData => {
            const result = {};
            columns.forEach(col => {
              result[col.field] = rowData[col.field];
            });
            return result;
          })
        ]);

        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Sheet1");

        const buf = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
        saveAs(new Blob([buf], { type: "application/octet-stream" }), "table_export.xlsx");
      }}
    />
  );
};

export default MyTable;



	onExport: This is where we customize the export logic.
	•	Two empty rows: The [{},{}, ...] array structure adds two empty objects, which Excel treats as two empty rows.
	•	XLSX Library: This library is used to generate and manipulate the Excel file.
	•	file-saver: This is used to trigger the download of the file.
npm install xlsx file-saver
